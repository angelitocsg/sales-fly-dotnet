@inject Blazored.LocalStorage.ILocalStorageService localStorage

@page "/meus-voos"
@using System.Text.Json
@using SalesFly.Shared.Models

<h1 class="mt-3 mb-3">Meus vôos</h1>

<div class="card">
    <div class="card-body">
        <table class="table table-hover">
            <thead>
                <tr>
                    <th>Número ticket</th>
                    <th class="text-center">Data da compra</th>
                    <th>Vôo</th>
                    <th class="text-end">Valor</th>
                </tr>
            </thead>
            <tbody>
                @if (carrinho!=null)
                @foreach (var item in carrinho.Items)
                {
                    <tr>
                        <td>#@carrinho.Ticket</td>
                        <td class="text-center">@carrinho.Data</td>
                        <td>@item.Origem > @item.Destino</td>
                        <td class="text-end">@(string.Format("R$ {0:#.00}", item.Valor))</td>
                    </tr>
                }
                </tbody>
            </table>
        </div>
    </div>

@code {
    private Carrinho carrinho;

    protected override async Task OnInitializedAsync()
    {
        carrinho = await localStorage.GetItemAsync<Carrinho>("meus_voos");

        Console.WriteLine(JsonSerializer.Serialize(carrinho));
        await base.OnInitializedAsync();
    }
}